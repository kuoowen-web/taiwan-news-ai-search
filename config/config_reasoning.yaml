reasoning:
  enabled: true
  max_iterations: 3
  analyst_timeout: 300  # Increased for debugging
  critic_timeout: 120   # Increased for debugging
  writer_timeout: 300   # Increased for debugging

  # Feature flags for enhanced reasoning capabilities
  features:
    user_friendly_sse: true   # Phase 1: User-friendly Chinese progress messages
    plan_and_write: true      # Phase 3: Plan-and-Write for long reports (2000+ words)
    argument_graphs: true     # Phase 2: Structured argument decomposition
    structured_critique: true # Phase 2: Structured weakness detection
    knowledge_graph_generation: false  # Phase KG: Entity-Relationship Knowledge Graph (per-request override via enable_kg param)
    gap_knowledge_enrichment: true    # Stage 5: Gap Detection with LLM Knowledge & Web Search
    cov_lite_enabled: true    # Phase 2 CoV: Chain of Verification for fact-checking claims

  # TypeAgent configuration (structured LLM output with automatic validation)
  typeagent:
    enabled: true             # Set to true to enable TypeAgent
    max_retries: 3            # Max retry attempts for validation errors
    instructor_mode: "tool_call"  # instructor mode: "tool_call" or "json_mode"

  # Timezone for current time context (used in temporal queries)
  timezone: "Asia/Taipei"

  # Stage 5: Tier 6 Knowledge Enrichment Configuration
  tier_6:
    llm_knowledge:
      enabled: true
      confidence_cap: "medium"   # Max confidence for LLM-generated knowledge
      max_answer_length: 300     # Max chars for inline LLM answers

    web_search:
      enabled: true
      provider: "google"         # Stage 5: Google Custom Search (Bing deprecated)
      max_results: 5             # Free tier: 100 queries/day, max 10 per request
      timeout: 3.0               # Timeout in seconds (prevents slow API blocking)
      fallback_to_local: true    # Continue with local sources on timeout
      max_snippet_length: 200    # Token optimization: truncate snippets
      cache:
        enabled: true
        ttl_hours: 1             # Cache validity period
        max_size: 100            # Max cached queries

    wikipedia:
      enabled: true              # Enable Wikipedia as Tier 6 source
      language: "zh"             # zh for Traditional Chinese, en for English
      max_results: 3             # Max Wikipedia articles per query
      max_summary_length: 500    # Max chars per summary
      timeout: 5.0               # Timeout in seconds
      cache:
        enabled: true
        ttl_hours: 24            # Wikipedia content changes less often
        max_size: 200            # Max cached queries

    # Phase 1 - 股價 API
    yfinance:
      enabled: true
      timeout: 5.0
      include_fundamentals: true
      cache:
        enabled: true
        ttl_hours: 0.25    # 15 分鐘
        max_size: 100

    twse:
      enabled: true
      timeout: 3.0
      cache:
        enabled: true
        ttl_hours: 0.083   # 5 分鐘
        max_size: 200

    # Phase 2 - 天氣 API
    cwb_weather:
      enabled: true
      api_key: ${CWB_API_KEY}   # 中央氣象署 API Key
      timeout: 5.0
      cache:
        enabled: true
        ttl_hours: 1
        max_size: 100

    # Phase 2 - 公司資料 API
    wikidata:
      enabled: true
      timeout: 8.0
      cache:
        enabled: true
        ttl_hours: 24
        max_size: 200

    tw_company:
      enabled: true
      timeout: 5.0
      cache:
        enabled: true
        ttl_hours: 168     # 7 天
        max_size: 200

    # Phase 3 - 全球天氣 API
    openweathermap:
      enabled: false       # 需要 API Key 才能啟用
      api_key: ${OPENWEATHERMAP_API_KEY}
      language: "zh_tw"
      timeout: 5.0
      cache:
        enabled: true
        ttl_hours: 1
        max_size: 100

    # Enrichment strategy: how to use multiple Tier 6 sources
    enrichment_strategy: "parallel"  # parallel (faster) or sequential (fallback)

  # Auto-REJECT thresholds for Phase 2 structured critique
  critique_thresholds:
    critical_weakness_count: 2  # Auto-escalate to REJECT if >= N critical weaknesses
    source_tier_violations: 1    # Max acceptable source tier violations

  tracing:
    console:
      enabled: true
      level: DEBUG  # ERROR, WARN, INFO, DEBUG, TRACE (local dev default: DEBUG)
      colors: true
    file:
      enabled: true
      save_event_stream: true
      save_full_data: true

source_tiers:
  # Tier 1: Official (3 sources)
  "中央社": {tier: 1, type: "official"}
  "公視": {tier: 1, type: "official"}
  "行政院": {tier: 1, type: "government"}

  # Tier 2: Mainstream (3 sources)
  "聯合報": {tier: 2, type: "news"}
  "經濟日報": {tier: 2, type: "news"}
  "自由時報": {tier: 2, type: "news"}

  # Tier 3: Digital (2 sources)
  "報導者": {tier: 3, type: "digital"}
  "關鍵評論網": {tier: 3, type: "digital"}

  # Tier 5: Social (2 sources)
  "PTT": {tier: 5, type: "social"}
  "Dcard": {tier: 5, type: "social"}

mode_configs:
  strict:
    max_tier: 2
  discovery:
    max_tier: 5
  monitor:
    compare_tiers: [1, 5]
